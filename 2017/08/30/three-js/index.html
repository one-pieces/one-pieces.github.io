<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>初始Three.js | One Pieces</title>

  
  <meta name="author" content="Xiaolong Lin">
  

  
  <meta name="description" content="小明是一名程序员，小红是小明的女朋友。
一天晚上，他们在床上重温《海贼王》的“顶上战争”。突然，小红说，我不想艾斯死。小明心头一震，“我也不想艾斯死！！！”。小明默默地把这件事情记在心里。为了完成他们两个人共同的愿望，小明苦思冥想，日夜奔波，时间也一点点地过去。
一天晚上，小明把小红叫到身边，然后打">
  

  
  
  <meta name="keywords" content="Three.js,3D">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="初始Three.js"/>

  <meta property="og:site_name" content="One Pieces"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="One Pieces" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">One Pieces</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>初始Three.js</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2017/08/30/three-js/" rel="bookmark">
        <time class="entry-date published" datetime="2017-08-30T06:30:28.000Z">
          2017-08-30
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>小明是一名程序员，小红是小明的女朋友。</p>
<p>一天晚上，他们在床上重温《海贼王》的“顶上战争”。<br>突然，小红说，我不想艾斯死。小明心头一震，“我也不想艾斯死！！！”。小明默默地把这件事情记在心里。为了完成他们两个人共同的愿望，小明苦思冥想，日夜奔波，时间也一点点地过去。</p>
<p>一天晚上，小明把小红叫到身边，然后打开了电脑，在浏览器地址栏上敲下下面的地址：<br><a href="http://one-pieces.me/threejs-practice/one-piece-top-war/index.html" target="_blank" rel="noopener">one-pieces</a></p>
<p>神奇的事情发生了！！！<br>雾草！艾斯出现！！！<br>滑一滑鼠标，还有七武海！！！</p>
<p>好叼！小红激动了，抓着小明的手，小明脸上洋溢着自豪和感动！！！<br>激动之余，小红问：“这是怎么做到的？”</p>
<p>这时小明略带诡异地笑了：“想知道吗？”<br>“想。”<br>“用Three.js啊。”小明自信地说道。<br>“Three.js?”身为程序员的女朋友，小红还是懂什么叫js，但何为Three.js（三.js ?），她不清楚。<br>“想知道吗？有点复杂哦。”<br>“不怕，我想听。”小红说道。<br>“好，那我就简单点说。”（灯光ok，摄像ok，音效ok，请开始你的表演，小明！）</p>
<h3 id="Three-js-WebGL与OpenGL"><a href="#Three-js-WebGL与OpenGL" class="headerlink" title="Three.js, WebGL与OpenGL"></a>Three.js, WebGL与OpenGL</h3><p>提到Three.js，就必须说一下OpenGL和WebGL。<br>OpenGL大概许多人都有所听闻，它是最常用的跨平台图形处理开源库。<br>WebGL就是基于OpenGL设计的面向web的3D图形标准，它提供了一系列JavaScript API，通过这些API进行图形渲染，系统硬件会加速3D渲染，从而获得较高性能。<br>而Three.js是JavaScript编写的WebGL第三方库，通过对WebGL接口的封装与简化而形成的一个易用的图形库。</p>
<h3 id="WebGL与Three-js对比"><a href="#WebGL与Three-js对比" class="headerlink" title="WebGL与Three.js对比"></a>WebGL与Three.js对比</h3><p>通过上面的简介，我们知道WebGL和Three.js都可以进行Web端的3D图形开发。那问题来了，既然我们有了WebGL，为什么还需要Three.js？<br>这是因为前端工程师想要短时间上手WebGL还是挺有难度的。<br>WebGL门槛相对较高，需要相对较多的数学知识。虽然WebGL提供的是面向前端的API，但本质上WebGL跟前端开发完成是两个不同的方向，知识的重叠很少。相关性只是他们都在web平台上，都是用JavaScript而已。一个前端程序员或许还熟悉解析几何，但是还熟悉线性代数的应该寥寥无几了（比如求个逆转置矩阵试试？），更何况使用中强调矩阵运算中的物理意义，这在教学中也是比较缺失的。<br>于是，Three.js对WebGL提供的接口进行了非常好的封装，简化了很多细节，大大降低了学习成本。并且，几乎没有损失WebGL的灵活性。<br>因此，从Three.js入手是值得推荐的，这可以让你在较短的学习后就能面对大部分需求场景。</p>
<h3 id="Three-js中的一些概念"><a href="#Three-js中的一些概念" class="headerlink" title="Three.js中的一些概念"></a>Three.js中的一些概念</h3><p>想在屏幕上展示3D物体，大体上的思路是这样的：</p>
<ol>
<li>创建一个三维空间，Three.js称之为场景（Scene）</li>
<li>确定一个观察点，并设置观察的方向和角度，Three.js称之为相机（Camera）</li>
<li>在场景中添加供观察的物体，Three.js中有很多种物体，如Mesh、Group、Line等，他们都继承自Object3D类。</li>
<li>最后我们需要把所有的东西渲染到屏幕上，这就是Three.js中的Renderer的作用。</li>
</ol>
<p>下面来仔细看看这些概念吧</p>
<h4 id="Scene"><a href="#Scene" class="headerlink" title="Scene"></a>Scene</h4><p>放置所有物体的空间容器，对应现实的三维空间。创建一个场景也很简单，只需直接new一个Scene类即可。</p>
<pre><code>var scene = new THREE.Scene();
</code></pre><h4 id="Camera"><a href="#Camera" class="headerlink" title="Camera"></a>Camera</h4><p>Camera相机，这个很好理解。“所见即所得”。虽然我是一个唯物主义者，不过只有被看到才能被感知。相机就相当于我们的眼睛，为了观察这个世界，我们需要描述某个物体的位置。描述物体位置需要用到坐标系。常用的坐标系有左手坐标系和右手坐标系。</p>
<p>Three.js采用的是右手坐标系。</p>
<p>Three.js中一共有四种相机，分别为CubeCamera、OrthographicCamera、PerspectiveCamera、StereoCamera，它们都继承自Camera类。我们常用的有两种，正投影相机THREE.OrthographicCamera和透视投影相机THREE.PerspectiveCamera。</p>
<h4 id="三维投影"><a href="#三维投影" class="headerlink" title="三维投影"></a>三维投影</h4><p>正投影相机THREE.OrthographicCamera和透视投影相机THREE.PerspectiveCamera，相信学过绘画的人一下子就能明白，它们对应三维投影中的正交投影和透视投影。</p>
<p>上面左图是正交投影，物体反射的光平行投射到屏幕上，其大小始终不变，所以远近的物体大小一样。在渲染一些2D效果和UI元素的时候会用到。右图是透视投影，符合我们平时看东西的感觉，近大远小，经常用在3D场景中。</p>
<h3 id="视景体"><a href="#视景体" class="headerlink" title="视景体"></a>视景体</h3><p>视景体是一个比较重要的概念。它是指成像景物所在空间的集合。简单点说，视景体是一个几何体，只有在视景体内的物体才会被我们看到，视景体之外的物体将被裁剪掉（所见即所得）。这是为了去除不必要的计算。通过变换视景体，我们就得到不同的相机。</p>
<p>正交投影相机OrthographicCamera的视景体是一个长方体，其构造函数为OrthographicCamera( left, right, top, bottom, near, far )。把Camera看作一个点，left则表示视景体左平面在左右方向上与Camera的距离，另外几个参数同理。于是六个参数分别定义了视景体六个面的位置。我们可以近似地认为，视景体里的物体平行投影到近平面上，然后近平面上的图像被渲染到屏幕上。</p>
<p>透视投影相机PerspectiveCamera的视景体是一个四棱台，其构造函数为PerspectiveCamera( fov, aspect, near, far )。fov即field of view，即视野，对应着图中的视角，是上下两面的夹角。aspect是近平面的宽高比。再加上近平面距离near，远平面距离far，就可以唯一确定这个视景体了。</p>
<h4 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h4><p>Objects就是三维空间里的物体。Three.js中提供了很多类型的物体，它们都继承自Object3D类，这里我们只看Mesh。</p>
<h4 id="Mesh"><a href="#Mesh" class="headerlink" title="Mesh"></a>Mesh</h4><p>有时当你察觉不到时，它就不在。这一点在计算机图形学中得到充分地体现。在计算机的世界里，一条弧线是由有限个点构成的有限条线段连接得到的。当线段数量越多，长度就越短，当达到你无法察觉这是线段时，一条平滑的弧线就出现了。<br>计算机的三维模型也是类似的。只不过线段变成了平面，普遍用三角形组成的网格来描述。我们把这种模型称之为Mesh模型。</p>
<p>这就是在3D图形处理中，与图像处理领域的lena图齐名的斯坦福兔子。随着三角形数量的增加，它的表面将会越来越平滑。<br>在Three.js中，Mesh的构造函数为Mesh( geometry, material )。geometry是它的形状，material是它的材质。</p>
<h4 id="Geometry"><a href="#Geometry" class="headerlink" title="Geometry"></a>Geometry</h4><p>Three中有很多种形状geometry，立方体、平面、球体、圆形、圆柱、圆台等许多基本形状。Geometry通过存储模型中的点集和点间关系（哪些点构成一个三角形）来描述物体形状。因此我们也可以通过自己定义每个点的位置来构造形状。我们还可以通过导入外部的模型文件来构造更加复杂的形状。</p>
<h4 id="Material"><a href="#Material" class="headerlink" title="Material"></a>Material</h4><p>这里的材质不仅仅指物体纹理，而是物体表面除了形状以外所有可视属性的集合，例如色彩、纹理、光滑度、透明度、反射率、折射率、发光度。<br>这里讲一下材质（Material）、贴图（Map）、纹理（Texture）的关系。<br>材质上面已经提到了，它包括了贴图一级其它。<br>贴图其实是“贴”和“图”，它包括了图片和图片应当贴到什么位置。<br>纹理嘛，其实就是“图”了。<br>Three提供了多种材质可供选择，能够自由地选择漫反射/镜面反射等材质。</p>
<h4 id="Light"><a href="#Light" class="headerlink" title="Light"></a>Light</h4><p>神说：要有光！<br>光影效果是让画面丰富的重要因素。<br>Three提供了包括环境光AmbientLight、点光源PointLight、聚光灯SpotLight、方向光DirectionalLight、半球光HemisphereLight等多种光源。<br>只要在场景中添加需要的光源就好了。</p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>好了，前面说了这么多，总该写代码了~~</p>
<p>根据上面说的，我们首先需要创建一个场景（Scene）、相机（Camera）、渲染器（Renderer）。</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Three-js/">Three.js</a><a href="/tags/3D/">3D</a>
    </span>
    

    </div>

    
  </div>
</article>


    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2018 Xiaolong Lin
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>